---
name: Titanium.UI.NavigationWindow
summary: |
    A `NavigationWindow` implements a specialized view that manages the navigation of hierarchical
    content.
description: |
    You create a `NavigationWindow` with the <Titanium.UI.createNavigationWindow> factory method or
    a `<NavigationWindow>` Alloy element.

    All `NavigationWindow` objects must have at least one root window that cannot be removed. When
    creating a `NavigationWindow` with the factory method, you must set its `window` property to the
    root level window. Equivalently, in an Alloy application, insert a `<Window>` element as a child of the
    `<NavigationWindow>` element. See examples below.

    This object is not meant to be added to other windows. However, it can be used within a <Titanium.UI.iOS.SplitWindow>.
platforms: [android, iphone, ipad, macos]
extends: Titanium.UI.Window
since: "8.0.0"
excludes:
    methods: [removeAllChildren, setToolbar]
    properties: [navBarHidden, tabBarHidden, navTintColor, translucent, toolbar,
                barColor, barImage, leftNavButton, rightNavButton, title, titleControl,
                titlePrompt, titleImage, titleid, titlepromptid, url, backButtonTitle,
                backButtonTitleImage, shadowImage, hideShadow, transitionAnimation,
                swipeToClose]

properties:
  - name: window
    summary: Window to add to this navigation window.
    type: Titanium.UI.Window
    availability: creation
    optional: false

  - name: interactiveDismissModeEnabled
    summary: |
        A boolean indicating whether or not child windows of this navigation window
        should have the ability to be swipe-to-closed over the full width of it's window or not.
    type: Boolean
    default: false
    platforms: [iphone, ipad, macos]
    since: "12.5.0"
    availability: creation
    deprecated:
      since: "13.0.0"
      removed: "13.0.0"
      notes: This is handled by the operation system in newer versions of iOS.

methods:
  - name: closeWindow
    summary: Closes a window and removes it from the navigation window.
    parameters:
      - name: window
        summary: Window to close.
        type: Titanium.UI.Window

      - name: options
        # TODO: This should be AnimatedOptions on iOS, equivalent to Ti.UI.Window.close arg on Android!
        summary: |
            Options supporting a single `animated` boolean property to determine whether the window
            will be animated (default) while being closed (default: true).
        type: Dictionary

  - name: openWindow
    summary: Opens a window within the navigation window.
    parameters:
      - name: window
        summary: Window to open.
        type: Titanium.UI.Window

      - name: options
        # TODO: this should be of a type equivalent to Ti.Ui.Window.open args!
        summary: |
            Options supporting a single `animated` boolean property to determine whether the window
            will be animated (default) while being opened (default: true).
        type: AnimatedOptions
        optional: true
        default: "{ animated: true }"

  - name: popToRootWindow
    summary: Closes all windows that are currently opened inside the navigation window.
    description: Note that only the `close` event of the most recently opened window is fired.
    parameters:
      - name: options
        # TODO: this should be of type equivalent to Ti.UI.Window.close arg on Android, AnimatedOptions on iOS!
        summary: |
            Options supporting a single `animated` boolean property to determine whether the windows
            will be animated while being closed (default: false).
        type: AnimatedOptions
        optional: true
        default: "{ animated: false }"

  - name: insertWindow
    summary: Inserts a window into the navigation stack at the specified index.
    description: |
        This method allows you to insert a window into the navigation stack at any position,
        enabling scenarios like deep linking where you want to start at a specific level
        in the navigation hierarchy while still allowing the user to navigate back to
        previous levels.

        The window will be inserted at the specified index in the navigation stack.
        Index 0 is the root window (which cannot be replaced), so the minimum useful
        index is 1. If the index is greater than the current stack size, the window
        will be appended to the end of the stack.

        This method returns a Promise that resolves when the window has been inserted.
        If you need to perform additional navigation operations after inserting,
        wait for the Promise to resolve first.

        Note: This method is only available on iOS. On Android, use the workaround of
        opening windows sequentially with `animated: false`.
    platforms: [iphone, ipad, macos]
    since: "12.7.0"
    returns:
        summary: A Promise that resolves when the window has been inserted.
        type: Promise<void>
    parameters:
      - name: window
        summary: Window to insert into the navigation stack.
        type: Titanium.UI.Window

      - name: index
        summary: |
            The index at which to insert the window. Index 0 is the root window.
            Use index 1 to insert a window right after the root window.
        type: Number

      - name: options
        summary: |
            Options supporting a single `animated` boolean property to determine whether the
            insertion will be animated (default: false).
        type: AnimatedOptions
        optional: true
        default: "{ animated: false }"

examples:
  - title: Simple Navigation Window
    example: |
        Creates a navigation window with the first window colored red.
        Press the button to open the blue window.
        Use the back button to return to the red root window.

        ``` js
        var win2 = Titanium.UI.createWindow({
            backgroundColor: 'red',
            title: 'Red Window'
        });

        var win1 = Titanium.UI.createNavigationWindow({
            window: win2
        });

        var win3 = Titanium.UI.createWindow({
            backgroundColor: 'blue',
            title: 'Blue Window'
        });

        var button = Titanium.UI.createButton({
            title: 'Open Blue Window'
        });
        button.addEventListener('click', function(){
            win1.openWindow(win3, {animated:true});
        });

        win2.add(button);
        var button2 = Titanium.UI.createButton({
            title: 'Close Blue Window'
        });
        button2.addEventListener('click', function(){
            win1.closeWindow(win3, {animated:false}); //win3.close() will also work!!
        });

        win3.add(button2);
        win1.open();
        ```

  - title: Alloy XML Markup
    example: |
        Previous example as two Alloy view-controllers.  Requires Alloy 1.2.2 and later.

        app/views/index.xml:
        ``` xml
        <Alloy>
            <NavigationWindow id="win1">
                <Window id="win2" title="Red Window" backgroundColor="red">
                    <Button id="button" onClick="openBlueWindow">Open Blue Window</Button>
                </Window>
            </NavigationWindow>
        </Alloy>
        ```

        app/controllers/index.js:
        ``` js
        function openBlueWindow(e) {
            var win3 = Alloy.createController('bluewin').getView();
            $.win1.openWindow(win3);
        }

        $.win1.open();
        ```

        app/views/bluewin.xml:
        ``` xml
        <Alloy>
            <Window id="win3" title="Blue Window" backgroundColor="blue">
                <Button onClick="closeWindow">Close Window</Button>
            </Window>
        </Alloy>
        ```

        app/controllers/bluewin.js:
        ``` js
        function closeWindow(){
            $.win3.close();
        }
        ```

  - title: Deep Linking with insertWindow (iOS only)
    example: |
        This example demonstrates how to use `insertWindow` to start at a deep level
        in the navigation hierarchy while still allowing the user to navigate back.

        ``` js
        // Create the root window
        var rootWindow = Ti.UI.createWindow({
            backgroundColor: 'white',
            title: 'Home'
        });

        // Create the navigation window
        var nav = Ti.UI.createNavigationWindow({
            window: rootWindow
        });

        // Create intermediate and detail windows
        var categoryWindow = Ti.UI.createWindow({
            backgroundColor: 'lightgray',
            title: 'Category'
        });

        var detailWindow = Ti.UI.createWindow({
            backgroundColor: 'lightblue',
            title: 'Product Detail'
        });

        // Open the navigation window
        nav.open();

        // Simulate deep link: insert category window, then open detail window
        // Use Promise to ensure proper sequencing
        nav.insertWindow(categoryWindow, 1, { animated: false })
            .then(() => nav.openWindow(detailWindow, { animated: false }));

        // Now the navigation stack is: [rootWindow, categoryWindow, detailWindow]
        // User can press back to go to categoryWindow, then back again to rootWindow
        ```

  - title: Insert window before closing current (iOS only)
    example: |
        This example shows how to insert a window and then close the current window,
        using the Promise to ensure proper sequencing.

        ``` js
        // Assuming nav is an open NavigationWindow and currentWindow is the top window
        var newWindow = Ti.UI.createWindow({
            backgroundColor: 'green',
            title: 'Inserted Window'
        });

        // Insert the new window before the current one, then close the current
        // The Promise ensures the insert completes before the close
        nav.insertWindow(newWindow, 1, { animated: false })
            .then(() => nav.closeWindow(currentWindow, { animated: true }));
        ```
